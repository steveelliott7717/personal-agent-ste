{
  "task": "Role: RMS GPT (planner+implementer)\nRepo: personal-agent-ste\nBranch: main\nPath prefix: backend/\n\nGoal:\nImplement request logging + correlation IDs via a small FastAPI middleware and a tiny logging utility. Keep it stdlib-only and backward compatible.\n\nRequirements:\n- Create backend/middleware/request_logging.py implementing a BaseHTTPMiddleware that generates/propagates a UUID4 correlation ID per request (header X-Request-Id if present; otherwise create). Store on request.state.correlation_id and a ContextVar. Respect env LOG_REQUESTS (default true): when true, log one line on finish with method, path, status, duration_ms, correlation_id. Always clear the ContextVar.\n- Create backend/logging_utils.py that defines a logging.Filter reading the ContextVar and injecting correlation_id into records, and a configure_logging() helper that sets a base format including %(correlation_id)s (fallback '-' when absent) and attaches the filter to the root logger. No external deps.\n- Wire in backend/main.py (or backend/api.py depending on the prod entrypoint): call configure_logging() at startup and add the middleware. Do not change existing response shapes. Skip /health in request logs, but still set correlation_id.\n- Do not touch unrelated files; keep diffs minimal and under backend/.\n\nAcceptance Criteria:\n- New files exist: backend/middleware/request_logging.py, backend/logging_utils.py.\n- App init calls configure_logging() and adds the middleware.\n- Every request gets a correlation_id; with LOG_REQUESTS=true, a single structured line is logged with method, path, status, duration_ms, correlation_id; with LOG_REQUESTS=false, only middleware request lines are suppressed but other logs still include correlation_id.\n- /health behavior unchanged.\n\nVerification Steps:\n1) Deploy and set LOG_REQUESTS=true. Call /health and one /app/api/* endpoint; run 'fly logs --since 5m' and observe correlation_id, method, path, status, duration_ms.\n2) Set LOG_REQUESTS=false and repeat; middleware request lines are suppressed while app logs still show correlation_id.\n\nConstraints:\n- Python stdlib only; no new heavy deps.\n- Minimal, reversible patch; respect path_prefix.\n\nOutput format (CRITICAL):\nReturn ONLY a unified diff (git-apply ready). DO NOT return JSON, hits, context, or any wrapperâ€”just the diff text starting with 'diff --git'.",
  "repo": "personal-agent-ste",
  "branch": "main",
  "path_prefix": "backend/",
  "k": 12,
  "session": "s1"
}