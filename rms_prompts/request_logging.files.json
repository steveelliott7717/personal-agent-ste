{
    "repo": "personal-agent-ste",
    "branch": "main",
    "path_prefix": "backend/",
    "k": 6,
    "session": "reqlog-files-1",
    "task": "FILES-MODE (STRICT). OUTPUT FORMAT: For each file, emit exactly:\nBEGIN_FILE <path>\n<ASCII+LF full content, ends with exactly one LF>\nEND_FILE\nNothing outside blocks. No prose/JSON/markdown. All paths under path_prefix.\n\nPINNED SCOPE: Touch ONLY these files:\n- backend/logging_utils.py (CREATE)\n- backend/main.py (EDIT)\n\nREQUIREMENTS:\n1) Create backend/logging_utils.py with:\n   - ContextVar-based correlation ID holder\n   - CorrelationIdFilter that injects correlation_id into all log records\n   - setup_logging() to configure logging (ASCII-only format) and attach the filter (idempotent)\n   - RequestLoggingMiddleware (Starlette BaseHTTPMiddleware) that:\n     * creates a UUID per request\n     * saves it to ContextVar and request.state.correlation_id\n     * logs start/end/errors with the correlation id\n     * sets X-Correlation-ID response header\n     * honors env LOG_REQUESTS (default true for {\"true\",\"1\",\"t\",\"yes\"})\n2) Modify backend/main.py (EXISTING FILE) ONLY to:\n   - add exactly ONE import: from backend.logging_utils import setup_logging, RequestLoggingMiddleware\n   - locate the exact anchor line: app = FastAPI(title=\"Personal Agent API\")\n   - insert IMMEDIATELY AFTER that anchor, on separate lines:\n     setup_logging()\n     app.add_middleware(RequestLoggingMiddleware)\n   - DO NOT re-declare or reassign app\n   - DO NOT move/alter load_dotenv(...) or any existing CORS config\n   - DO NOT add routes or change unrelated code\n\nFORMAT & HYGIENE:\n- ASCII only; LF line endings; exactly one trailing LF per file\n- No unicode arrows or fancy quotes\n- Keep changes minimal and surgical\n\nACCEPTANCE & VERIFICATION:\n- Server boots successfully\n- GET /health returns {\"status\":\"ok\"}\n- Responses include X-Correlation-ID header\n- When LOG_REQUESTS=true (or 1/t/yes), request start/end lines appear with the correlation id in logs\n\nDELIVERABLE:\n- Two BEGIN_FILE/END_FILE blocks ONLY for backend/logging_utils.py and backend/main.py"
}